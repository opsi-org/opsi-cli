pyinstaller-poetry:
  one_file: yes
  strip: yes
  before_script:
    - find plugins -name __pycache__ -exec rm -rf {} +
  hidden_imports:
    all:
      - orjson
      - psutil
      - opsicli.io
      - opsicli.cache
      - opsicli.opsiservice
      - pip._internal.commands.install
    windows:
      - pip._vendor.platformdirs.windows
    darwin:
      - pip._vendor.platformdirs.macos
  extra_args:
    - --exclude-module=cryptography
    - --exclude-module=tkinter
    - --exclude-module=tan
    - --exclude-module=pytest
    - --exclude-module=flake8
    - --exclude-module=isort
    - --exclude-module=mypy
  scripts:
    - script: run-opsicli
      binaries:
        - opsi-cli
  data_files:
    - src: ${VENV_SITE_PACKAGES}/pip/_vendor/certifi/cacert.pem
      dst: pip/_vendor/certifi
    - src: ${VENV_SITE_PACKAGES}/pipreqs/stdlib
      dst: pipreqs
    - src: ${VENV_SITE_PACKAGES}/pipreqs/mapping
      dst: pipreqs
    - src: plugins/**/*
      dst: plugins
  dirname: opsicli
  locale_install: []
